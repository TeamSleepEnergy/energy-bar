<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" http-equiv="Content-Type">
    <title>Energy Bar Home Page</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- Custom side nav bar CSS -->
    <link href="css/sidenav.css" rel="stylesheet">
    <!--Energy bar css-->
    <link href="css/energy-bar.css" rel="stylesheet">
    <!-- CSS for clock -->
    <link href="css/clock.css" rel="stylesheet">
    <!-- CSS for timepicker -->
    <link href="css/bootstrap-timepicker.min.css">
    <!-- Increase/ decrease energy bar JavaScript-->
    <script src="js/timing.js"></script>
    <script type="text/javascript" src="js/jquery.min.js"></script>
</head>

<body>
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="index.html">Home</a>
      <!--  <a href="data.html">Data</a> -->
        <a href="settings.html">Settings</a>
        <text> ----------------------------------------------</text>
        <a href="login.html">Log out</a>
    </div>

    <span style="font-size:3em;cursor:pointer" onclick="openNav()">&#9776;</span>

    <!-- Container for Jumbotron that includes current time & wake-up time -->
    <div class="container">
        <div class="jumbotron d-flex align-items-center">
            <div id="clockbox"></div>
            <div class="div-horizontal" align="center">
                <label class="col-sm-5 control-label" for="UserInput"><i>Wake up at:</i></label>
                <div class="col-sm-3">
                    <select class="form-control input-sm" id="UserInput" autofocus>

                        <option>01:00 AM</option>
                        <option>01:30 AM</option>
                        <option>02:00 AM</option>
                        <option>02:30 AM</option>
                        <option>03:00 AM</option>
                        <option>03:30 AM</option>
                        <option>04:00 AM</option>
                        <option>04:30 AM</option>
                        <option>05:00 AM</option>
                        <option>05:30 AM</option>
                        <option>06:00 AM</option>
                        <option>06:30 AM</option>
                        <option>07:00 AM</option>
                        <option>07:30 AM</option>
                        <option>08:00 AM</option>
                        <option>08:30 AM</option>
                        <option>09:00 AM</option>
                        <option>09:30 AM</option>
                        <option>10:00 AM</option>
                        <option>10:30 AM</option>
                        <option>11:00 AM</option>
                        <option>11:30 AM</option>
                        <option>12:00 PM</option>
                        <option>12:30 PM</option>
                        <option>01:00 PM</option>
                        <option>01:30 PM</option>
                        <option>02:00 PM</option>
                    </select>
                </div>
                <div class="col-sm-2" align="left">
                    <button id="setButton" type="button" class="btn" onclick="initBar()">
                        Set</button>
                </div>
            </div>
        </div>
    </div>

    <!--timepicker stuff-->
    <!--  <div class="input-group bootstrap-timepicker timepicker">
            <input id="timepicker1" type="text" class="form-control input-small">
            <span class="input-group-addon"><i class="glyphicon glyphicon-time"></i></span>
        </div>

        <script type="text/javascript">
            $('#timepicker1').timepicker();
        </script>
-->

    <div class="container" align="right">
        <!-- Health effects popover -->
        <a tabindex="0" class="btn btn-lg btn-info" role="button" data-toggle="popover" data-trigger="focus"
            data-placement="bottom" data-content="(insert health facts for current energy level)">Health Effects</a>
    </div>

    <div class="container">
        <div align="center">
            <br>
            <br>
            <div class="col">
                <!--<div class="progress progress-bar-vertical">
        <div class="progress-bar" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100" style="height: 30%;">
          <span class="sr-only">30% Complete</span>
        </div>
      </div>-->
                <div class="progress vertical">
                    <div id ="bar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0"
                        aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--Energy bar related functions-->
    <script>
        var energyBar = document.getElementById("bar");

        function initBar() {
            //id.style.width = "100%";
            //$("#bar").css("width", 100 + "%");
            //$("#bar").attr("aria-valuenow", "100");
            $("#bar").css("width", 100 + "%");
            $("#bar").attr("aria-valuenow", "100");
            var date = new Date();
            var hour = date.getHours();
            var min = date.getMinutes();
            var dropDown = document.getElementById("UserInput");
            var wakeUpString = dropDown.options[dropDown.selectedIndex].text;
            var wakeHour = Number(wakeUpString.charAt(0)+wakeUpString.charAt(1));
            var wakeMin = Number(wakeUpString.charAt(3)+wakeUpString.charAt(4));
            var pmCheck = wakeUpString.charAt(6);
            var sleptHours = Math.abs((24 - hour) + wakeHour);
            if(pmCheck == "P"){
                sleptHours += 12;
            }
            var sleptMin = Math.abs((60 - min) - wakeMin);
            if(min > wakeMin){
              var carryover = 1;
            }
            else{
              var carryover = 0;
            }
            var totalSleep = (sleptHours-carryover)*60 + sleptMin;
            var current_progress = 100//parseInt($("#bar").css("width")); //replace this value with val relative to time

            if (totalSleep < 480){
              current_progress = (totalSleep/480)*100;
            }
            $("#bar").css("width", current_progress + "%")
            var interval = setInterval(function () {
                current_progress -= 1; //
                $("#bar").css("width", current_progress + "%")
                .attr("aria-valuenow", current_progress)
                //.text(current_progress + "% Complete");
                if(current_progress <= 0)
                    clearInterval(interval);
         }, 288000); //scale this to wake up time*/
       }

/*       $(function () {
            $("#bar").css("width", 100 + "%");
            var current_progress = parseInt($("#bar").css("width")); //replace this value with val relative to time
            var interval = setInterval(function () {
                current_progress -= 5; //
                $("#bar").css("width", current_progress + "%")
                //.attr("aria-valuenow", current_progress)
                //.text(current_progress + "% Complete");
                /*if(current_progress <= 0)
                    clearInterval(interval);*/
  //       }, 1000); //scale this to wake up time
  //    });

        //var timeDown = setInterval(decBar, 1000);

    </script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Popper (necessary for Bootstrap's Popover functionality) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <!-- JavaScript for side nav bar functionality -->
    <script src="js/sidenav.js"></script>
    <!-- Activate Health Effects popover -->
    <script>
        $(document).ready(function () {
            $('[data-toggle="popover"]').popover();
        });
    </script>

    <!-- JavaScript for clock -->
    <script src="js/clock.js"></script>
    <!-- JavaScript for timepicker -->
    <script src="js/bootstrap-timepicker.min.js"></script>
</body>

</html>
